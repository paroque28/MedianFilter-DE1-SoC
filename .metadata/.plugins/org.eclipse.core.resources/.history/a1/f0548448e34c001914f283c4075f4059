/*
 ============================================================================
 Name        : ARM.c

 Author      : Pablo Rodriguez Quesada
 Version     :
 Copyright   : BSD 3-Clause License
 Description : Hello World in C, Ansi-style
 ============================================================================
 */
#include "ARM.h"

#define ALT_LWFPGASLVS_OFST 0xFF200000
#define LED_PIO_SPAN            0x10

int main(void)
{

	unsigned long *onchip_mem;
	int fd;
	int i;


	puts("Median Filter!!!"); /* prints Median Filter */

	fd = open("/dev/mem", (O_RDWR | O_SYNC));


	//Map LED_PIO Physical Address to Virtual Address Space
	onchip_mem = mmap( NULL, LED_PIO_SPAN, ( PROT_READ | PROT_WRITE ), MAP_SHARED, fd, (ALT_LWFPGASLVS_OFST + ONCHIP_MEMORY_BASE) );

	//Toggle all LEDs every 500ms a few times
	for (i=0; i < 10; i++)
	{
	   *onchip_mem ^= 0xFF; //Bit0=LED0 … Bit7=LED7
	   usleep(1000*500);
	}


	//Unmap
	munmap(onchip_mem, LED_PIO_SPAN);

	close(fd);
	return(0);
}
